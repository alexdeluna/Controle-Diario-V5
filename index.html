<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle Di√°rio V5</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#000000">

  <!-- Links COMPLETOS para as bibliotecas de exporta√ß√£o (CORRE√á√ÉO AQUI) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <style>
    body { font-family: sans-serif; background: #f0f2f5; margin: 0; padding: 0; }
    .app { max-width: 500px; margin: 0 auto; background: #fff; min-height: 100vh; padding: 20px; box-sizing: border-box; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    .linha { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; gap: 10px; }
    label { flex: 1; font-size: 14px; font-weight: bold; }
    input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
    button { padding: 10px; cursor: pointer; border: none; border-radius: 4px; background: #007bff; color: white; font-weight: bold; }
    button:active { opacity: 0.8; }
    .readonly { background: #e9ecef; color: #495057; }
    .tela { display: none; }
    .tela.ativa { display: block; }
    .menu button { width: 100%; margin-bottom: 10px; padding: 15px; font-size: 16px; text-align: left; }
    .nav { display: flex; justify-content: space-between; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; }
    .btn-block { width: 100%; margin-top: 10px; }
    .btn-save { background: #28a745; }
    .btn-danger { background: #dc3545; }
  </style>
</head>
<body>

<div class="app">
  <section id="menu" class="tela ativa menu">
    <h2>Menu Principal</h2>
    <button onclick="irPara('inicioTurno')">‚ñ∂ Iniciar Turno</button>
    <button onclick="irPara('custos')">‚õΩ Lan√ßar Custos / Ganhos</button>
    <button onclick="irPara('fimTurno')">‚èπ Finalizar Turno</button>
    <button onclick="irPara('resumoDia')">üìÖ Resumo do Dia</button>
    <button onclick="irPara('metasMensais')">üìà Metas Mensais</button>
    <button onclick="irPara('historicoGeral')">üìö Hist√≥rico Geral</button>
  </section>

  <section id="inicioTurno" class="tela">
    <h2>In√≠cio de Turno</h2>
    <div class="linha">
      <label>Hora In√≠cio</label>
      <input id="horaInicio" type="tel" placeholder="Ex: 0620" maxlength="5">
      <button onclick="capturarHora('horaInicio')">‚è±</button>
    </div>
    <div class="linha">
      <label>KM Inicial</label>
      <input id="kmInicial" type="number" placeholder="Ex: 12500">
    </div>
    <button class="btn-block btn-save" onclick="confirmarInicioTurno()">‚úÖ Iniciar Agora</button>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>

  <section id="custos" class="tela">
    <h2>‚õΩ Custos e Ganhos</h2>
    <div class="linha"><label>Abastecimento R$</label><input id="valorAbastecimento" type="number" step="0.01"><button onclick="adicionarAbastecimento()">+</button></div>
    <div class="linha"><label>Total Gasto ‚õΩ</label><input id="totalAbastecido" class="readonly" type="text" readonly value="0.00"></div>
    <hr>
    <div class="linha"><label>Outros Custos R$</label><input id="valorOutrosCustos" type="number" step="0.01"><button onclick="adicionarOutrosCustos()">+</button></div>
    <div class="linha"><label>Total Outros</label><input id="totalOutrosCustos" class="readonly" type="text" readonly value="0.00"></div>
    <div class="linha"><label>TOTAL CUSTOS</label><input id="totalCustos" class="readonly" type="text" readonly style="font-weight:bold"></div>
    <hr>
    <div class="linha"><label>VALOR APURADO R$</label><input id="apurado" type="number" step="0.01" placeholder="Ganhos totais"></div>
    <button class="btn-block btn-save" onclick="inserirApurado()">üíæ Salvar Dados</button>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button><button onclick="irPara('fimTurno')">Finalizar ‚û°</button></div>
  </section>

  <section id="fimTurno" class="tela">
    <h2>‚èπ Fim de Turno</h2>
    <div class="linha"><label>Hora Fim</label><input id="horaFim" type="tel" placeholder="HH:MM" maxlength="5"><button onclick="capturarHora('horaFim')">‚è±</button></div>
    <div class="linha"><label>KM Final</label><input id="kmFinal" type="number"></div>
    <button class="btn-block btn-danger" onclick="confirmarFimTurno()">‚èπ Encerrar Turno</button>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>

  <section id="resumoTurno" class="tela">
    <h2>üìä Resumo do Turno</h2>
    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; line-height: 2;">
      <div>Tempo: <strong id="resumoHoras">-</strong></div>
      <div>Rodado: <strong id="resumoKM">-</strong></div>
      <div>Custos: <strong id="resumoCustos">-</strong></div>
      <div>Lucro: <strong id="resumoLucro" style="color:green">-</strong></div>
      <div>Valor/Hora: <strong id="resumoValorHora">-</strong></div>
    </div>
    <button class="btn-block btn-save" style="margin-top:20px" onclick="salvarTurnoNoHistorico()">‚úÖ Arquivar e Limpar para Novo Turno</button>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>

  <section id="resumoDia" class="tela">
    <h2>üìÖ Resumo do Dia (Hoje)</h2>
    <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; line-height: 2;">
      <p>Intervalo Total: <strong id="diaHorasTrabalhadas">00:00h</strong></p>
      <p>KM Total Rodado: <strong id="diaKM">0 km</strong></p>
      <p>Total Abastecido: <strong id="diaAbastecido">R$ 0.00</strong></p>
      <p>Outros Custos: <strong id="diaOutrosCustos">R$ 0.00</strong></p>
      <p>Valor Apurado: <strong id="diaApurado">R$ 0.00</strong></p>
      <hr>
      <p>Lucro do Dia: <strong id="diaLucro" style="color:green; font-size:1.2em;">R$ 0.00</strong></p>
      <p>Valor M√©dio da Hora: <strong id="diaValorHora">R$ 0.00/h</strong></p>
    </div>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>
  
  <section id="metasMensais" class="tela">
    <h2>üìà Metas Mensais</h2>
    <div style="border: 1px solid #007bff; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
      <div class="linha"><label>Valor da Meta Mensal</label><input id="valorMetaMensal" type="number" step="0.01"><button onclick="atualizarMetaMensal()">üíæ Salvar</button></div>
      <button class="btn-block btn-danger" onclick="apagarMetaMensal()" style="font-size:12px; margin-top:-10px; margin-bottom:15px;">Apagar Meta e Custos Fixos</button>
      <hr>
      <div class="linha"><label>Descri√ß√£o Custo Fixo</label><input id="descricaoCustoFixo" type="text" placeholder="Ex: Parcela Carro"></div>
      <div class="linha"><label>Valor R$</label><input id="valorCustoFixo" type="number" step="0.01"><button onclick="inserirCustoFixo()">+</button></div>
      <hr>
      <strong>Lista de Custos Fixos:</strong>
      <ul id="listaCustosFixos" style="list-style: none; padding: 0;"></ul>
      <div class="linha" style="margin-top: 15px;"><label style="font-size: 16px;">Total Custos Fixos</label><input id="totalCustosFixos" class="readonly" type="text" readonly style="font-weight: bold;"></div>
    </div>
    <div style="background: #e9ecef; padding: 15px; border-radius: 5px;">
        <div class="linha"><label>Sua Meta</label><input id="resumoSuaMeta" class="readonly" type="text" readonly></div>
        <div class="linha"><label>Total Custos Fixos</label><input id="resumoTotalCustosFixos" class="readonly" type="text" readonly></div>
        <hr>
        <div class="linha"><label>Lucro do m√™s</label><input id="resumoLucroDoMes" class="readonly" type="text" readonly></div>
        <div class="linha"><label style="font-size: 1.1em; font-weight: bold; color: #dc3545;">Falta Para Atingir a Meta</label><input id="resumoFaltaParaMeta" class="readonly" type="text" readonly style="color: #dc3545; font-size: 1.1em; font-weight: bold;"></div>
    </div>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>

  <section id="historicoGeral" class="tela">
    <h2>üìö Hist√≥rico Geral</h2>
    <ul id="listaHistorico" style="list-style: none; padding: 0;"></ul>
    <button class="btn-block" onclick="exportarExcel()">‚¨áÔ∏è Exportar para Excel/CSV</button>
    <button class="btn-block" onclick="exportarPDF()">‚¨áÔ∏è Exportar para PDF</button>
    <button class="btn-block btn-danger" onclick="limparTodoHistorico()" style="font-size:12px">Apagar Todo Hist√≥rico</button>
    <div class="nav"><button onclick="irPara('menu')">‚¨Ö Menu</button></div>
  </section>
</div>
<script src="./app.js"></script>
</body>
</html>

